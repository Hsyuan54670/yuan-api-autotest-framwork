get_funds_log_list_normal_default_page_size:
  allure:
    title: "获取经费日志列表-正常场景-默认页码和每页条数"
    description: "验证不传分页参数时，接口能正确返回第一页、每页5条的经费审批日志数据"
    epic: "项目管理平台"
    feature: "经费审批模块"
    story: "获取经费日志列表"
    tag: ["正常场景", "分页查询"]
    pytest_mark: "smoke"
  steps:
    request:
      method: GET
      url: /admin/fundsLogList
      headers: {}
      params: {}
      json: {}
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records", "total", "size", "current"]
          assert:
            type:
              total: int
              size: int
              current: int
          list_check:
            records:
              length: 5
              every_item_required_fields:
                - "id"
                - "projectId"
                - "applicant"
                - "reason"
                - "appliedFunds"
                - "remainingFunds"
                - "applicantId"
                - "appliedTime"

get_funds_log_list_normal_custom_page_size:
  allure:
    title: "获取经费日志列表-正常场景-自定义页码和每页条数"
    description: "验证传入page=1, size=10时，接口能正确返回指定分页的经费审批日志数据"
    epic: "项目管理平台"
    feature: "经费审批模块"
    story: "获取经费日志列表"
    tag: ["正常场景", "分页查询"]
    pytest_mark: "regression"
  steps:
    request:
      method: GET
      url: /admin/fundsLogList
      headers: {}
      params:
        page: 1
        size: 10
      json: {}
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records", "total", "size", "current"]
          assert:
            eq:
              size: 10
            type:
              total: int
              current: int
          list_check:
            records:
              length: 10
              every_item_required_fields:
                - "id"
                - "projectId"
                - "applicant"
                - "reason"
                - "appliedFunds"
                - "remainingFunds"
                - "applicantId"
                - "appliedTime"

get_funds_log_list_abnormal_page_negative:
  allure:
    title: "获取经费日志列表-异常场景-页码为负数"
    description: "验证当page为负数时，接口仍能返回成功响应，但数据为空或默认处理"
    epic: "项目管理平台"
    feature: "经费审批模块"
    story: "获取经费日志列表"
    tag: ["异常场景", "边界值测试"]
    pytest_mark: "regression"
  steps:
    request:
      method: GET
      url: /admin/fundsLogList
      headers: {}
      params:
        page: -1
        size: 5
      json: {}
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records", "total", "size", "current"]
          assert:
            eq:
              current: -1
          list_check:
            records:
              every_item_required_fields:
                - "id"
                - "projectId"
                - "applicant"
                - "reason"
                - "appliedFunds"
                - "remainingFunds"
                - "applicantId"
                - "appliedTime"

get_funds_log_list_abnormal_size_exceed_limit:
  allure:
    title: "获取经费日志列表-异常场景-每页条数超过系统限制"
    description: "验证当size设置为非常大（如1000）时，接口是否进行合理截断或返回错误"
    epic: "项目管理平台"
    feature: "经费审批模块"
    story: "获取经费日志列表"
    tag: ["异常场景", "边界值测试"]
    pytest_mark: "regression"
  steps:
    request:
      method: GET
      url: /admin/fundsLogList
      headers: {}
      params:
        page: 1
        size: 1000
      json: {}
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records", "total", "size", "current"]
          assert:
            type:
              total: int
              current: int
          list_check:
            records:
              length: 100
              every_item_required_fields:
                - "id"
                - "projectId"
                - "applicant"
                - "reason"
                - "appliedFunds"
                - "remainingFunds"
                - "applicantId"
                - "appliedTime"

get_funds_log_list_with_auth_token:
  allure:
    title: "获取经费日志列表-正常场景-携带有效JWT Token"
    description: "验证在请求头中携带有效Authorization Token时，管理员可以成功获取经费日志列表"
    epic: "项目管理平台"
    feature: "经费审批模块"
    story: "获取经费日志列表"
    tag: ["正常场景", "鉴权测试"]
    pytest_mark: "smoke"
  steps:
    request:
      method: GET
      url: /admin/fundsLogList
      headers:
        Authorization: "${admin_token}"
      params:
        page: 1
        size: 5
      json: {}
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records", "total", "size", "current"]
          assert:
            type:
              total: int
              size: int
              current: int
          list_check:
            records:
              length: 5
              every_item_required_fields:
                - "id"
                - "projectId"
                - "applicant"
                - "reason"
                - "appliedFunds"
                - "remainingFunds"
                - "applicantId"
                - "appliedTime"
    extract:
      funds_log_first_record_id: $.data.records[0].id
      funds_log_total_count: $.data.total