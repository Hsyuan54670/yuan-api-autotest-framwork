get_unpassed_projects_normal_user_has_unpassed_projects:
  allure:
    title: "获取未通过项目-正常场景-用户存在未通过审批的项目"
    description: "验证已登录用户调用接口时，能正确返回状态为'待审核'或'已驳回'的项目列表"
    epic: "项目管理平台"
    feature: "项目查询模块"
    story: "获取未通过审批的项目"
    tag: ["正常场景", "冒烟用例"]
    pytest_mark: "smoke"
  steps:
    request:
      method: GET
      url: /project/getUnpassedProjects
      headers:
        Content-Type: "application/json"
        Authorization: "${login_token}"
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records"]
          assert:
            eq:
              msg: "success"
            type:
              code: int
          list_check:
            records:
              length: 2
              every_item_required_fields:
                - "id"
                - "projectName"
                - "projectType"
                - "applicant"
                - "funds"
                - "status"
    extract:
      unpassed_project_list: $.data.records

get_unpassed_projects_abnormal_no_login:
  allure:
    title: "获取未通过项目-异常场景-未登录访问接口"
    description: "验证未携带token时调用接口，应返回401未授权错误"
    epic: "项目管理平台"
    feature: "项目查询模块"
    story: "获取未通过审批的项目"
    tag: ["异常场景", "安全测试"]
    pytest_mark: ""
  steps:
    request:
      method: GET
      url: /project/getUnpassedProjects
      headers:
        Content-Type: "application/json"
    expected:
      status_code: 401
      response:
        code: 401
        msg: "Unauthorized"
        data:
          assert:
            eq:
              msg: "Unauthorized"
            type:
              code: int

get_unpassed_projects_normal_user_no_unpassed_projects:
  allure:
    title: "获取未通过项目-边界场景-用户无任何未通过审批的项目"
    description: "验证用户没有任何待审核或已驳回项目时，接口应成功返回空列表"
    epic: "项目管理平台"
    feature: "项目查询模块"
    story: "获取未通过审批的项目"
    tag: ["边界场景", "空数据测试"]
    pytest_mark: "regression"
  steps:
    request:
      method: GET
      url: /project/getUnpassedProjects
      headers:
        Content-Type: "application/json"
        Authorization: "${login_token}"
    expected:
      status_code: 200
      response:
        code: 200
        msg: "success"
        data:
          required_fields: ["records"]
          list_check:
            records:
              length: 0